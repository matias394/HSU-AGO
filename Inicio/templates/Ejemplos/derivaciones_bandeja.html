{% extends "includes/base.html" %};
{% load static %};

{% block head %}

{% endblock %}

{% block title %}Derivaciones{% endblock %};

{% block titulo-pagina %}Derivaciones{% endblock %};

{% block menu-adicional %}
{% endblock %};

{% block content %}

<div class="row">
  <div class="col-md-3">
    <a href="{% url 'derivaciones_buscar' %}" class="btn btn-primary btn-block mb-3">Derivar</a>
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">Carpetas</h3>
      </div>
      <div class="card-body p-0 d-block">
        <ul class="nav nav-pills flex-column">
          <li class="nav-item">
            <a href="#" class="nav-link filtro" data-filtro="todos" title="Mostrar todas las derivaciones">
              <i class="fas fa-inbox pr-2"></i> Todas
            </a>
          </li>
          <li class="nav-item filtro" data-filtro="Pendiente" title="Filtrar sólo derivaciones pendientes">
            <a href="#" class="nav-link">
              <i class="fas fa-filter pr-2"></i> Pendientes
              <span class="badge bg-primary float-right">3</span>
            </a>
          </li>
          <li class="nav-item filtro" data-filtro="En análisis" title="Filtrar sólo derivaciones en análisis">
            <a href="#" class="nav-link">
              <i class="fas fa-filter pr-2"></i> En análisis
              <span class="badge bg-secondary float-right">1</span>
            </a>
          </li>
          <li class="nav-item filtro" data-filtro="Aceptada" title="Filtrar sólo derivaciones aceptadas">
            <a href="#" class="nav-link">
              <i class="fas fa-filter pr-2"></i> Aceptadas
              <span class="badge bg-secondary float-right">3</span>
            </a>
          </li>
          <li class="nav-item filtro" data-filtro="Rechazada" title="Filtrar sólo derivaciones rechazadas">
            <a href="#" class="nav-link">
              <i class="fas fa-filter pr-2"></i> Rechazadas
              <span class="badge bg-secondary float-right">4</span>
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <div class="col-md-9">
    <div class="card card-primary card-outline">
      <div class="card-header mt-2">
        <h3 class="card-title">Bandeja de derivaciones</h3>
        <div class="card-tools">
          <div class="input-group input-group-sm">
            <input type="text" class="form-control" placeholder="Buscar">
            <div class="input-group-append">
              <div class="btn btn-primary">
                <i class="fas fa-search"></i>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="card-body p-0">
        <div class="mailbox-controls">
          <div class="float-right m-3">
            1|1
          </div>

        </div>
        <div class="table-responsive mailbox-messages">
          <table class="table table-hover table-striped" id="tabla-derivaciones">
            <tbody>
              <tr>
                <td class="mailbox-date">15/05/2023</td>
                <td>Servicio local</td>
                <td> <span class="font-weight-bold">Pendiente</span>
                <td class=""><span class="badge badge-warning">Media</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Maradona, Diego Armando - DNI
                    27373129</a></td>
                <td class="">1 alerta</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>
              <tr>
                <td class="mailbox-date">15/05/2023</td>
                <td>Módulos habitacionales</td>
                <td> <span class="font-weight-bold">Pendiente</span>
                <td class=""><span class="badge badge-warning">Media</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Maradona, Diego Armando - DNI
                    27373129</a></td>
                <td class="">1 alerta</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>
              <tr>
                <td class="mailbox-date">15/05/2023</td>
                <td>Descentralizado</td>
                <td> <span class="font-weight-bold">Pendiente</span>
                <td class=""><span class="badge badge-warning">Media</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Maradona, Diego Armando - DNI
                    27373129</a></td>
                <td class="">1 alerta</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>
              <tr>
                <td class="mailbox-date">02/04/2023</td>
                <td>Externo</td>
                <td>Rechazada</td>
                <td class=""><span class="badge badge-success">Baja</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Juan Perez - DNI 27373129</a>
                </td>
                <td class="">3 alertas</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>
              <tr>
                <td class="mailbox-date">02/04/2023</td>
                <td>Externo</td>
                <td>Rechazada</span></td>
                <td class=""><span class="badge badge-danger">Alta</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Juan Perez - DNI 27373129</a>
                </td>
                <td class="">3 alertas</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>
              <tr>
                <td class="mailbox-date">13/03/2023</td>
                <td>Centros 0 a 18</td>
                <td>En análisis</span></td>
                <td class=""><span class="badge badge-success">Baja</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Del Mar, María - DNI
                    27373129</a></td>
                <td class="">sin alertas</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>
              <tr>
                <td class="mailbox-date">13/03/2023</td>
                <td>Centros 0 a 18</td>
                <td>En análisis</span></td>
                <td class=""><span class="badge badge-success">Baja</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Del Mar, María - DNI
                    27373129</a></td>
                <td class="">sin alertas</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>
              <tr>
                <td class="mailbox-date">03/03/2023</td>
                <td>Programas sociales</td>
                <td>Aceptada</td>
                <td class=""><span class="badge badge-success">Baja</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Digiacomo, Marcos - DNI
                    27373129</a></td>
                <td class="">sin alertas</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>
              <tr>
                <td class="mailbox-date">13/03/2023</td>
                <td>Programas sociales</td>
                <td>Rechazada</td>
                <td class=""><span class="badge badge-success">Baja</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Moro, Pedro - DNI
                    27373129</a></td>
                <td class="">1 alerta</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>
              <tr>
                <td class="mailbox-date">13/03/2023</td>
                <td>CDLE</td>
                <td>Rechazada</td>
                <td class=""><span class="badge badge-success">Baja</span></td>
                <td class=""><a href="{% url 'derivaciones_detail' %}" title="Ver detalle">Del Mar, María - DNI
                    27373129</a></td>
                <td class="">2 alertas</td>
                <td class=""><i class="fas fa-paperclip"></i></td>
              </tr>

            </tbody>
          </table>

        </div>

      </div>

      <div class="card-body p-0">
        <div class="mailbox-controls">
          <div class="float-right m-3">
            1|1

          </div>

        </div>
      </div>
    </div>

  </div>

</div>
{% endblock content %}

{% block customJS %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function () {
    // Agregar un evento de clic a cada elemento del menú
    $('.filtro').on('click', function () {
      // Obtener el valor del filtro almacenado en el atributo 'data-filtro'
      const filtro = $(this).data('filtro');

      // Mostrar todas las filas de la tabla
      $('#tabla-derivaciones tbody tr').show();

      // Filtrar la tabla ocultando las filas que no coincidan con el filtro
      if (filtro !== 'todos') {
        $('#tabla-derivaciones tbody tr').each(function () {
          const fila = $(this);
          const columna = fila.find('td:nth-child(3)'); // Obtener la columna 3 (índice 2)

          // Comparar el valor de la columna con el filtro y ocultar la fila si no coincide
          if (columna.text().trim() !== filtro) {
            fila.hide();
          }
        });
      }
    });
  });
</script>

{% endblock %}